<!DOCTYPE html> <html lang="es"> <head> <meta charset="UTF-8" /> <meta name="viewport"content="width=device-width, initial-scale=1.0"> <title>Reserva Sala White</title> <style> body { font-family: sans-serif; max-width: 400px; margin: auto; background: #f0f8ff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10pxrgba(0,0,0,0.1); } h2 { text-align: center; color: #333; } label { display: block; margin-top: 15px; margin-bottom: 5px;font-weight: bold; color: #555; } input[type="text"], input[type="email"], input[type="date"], input[type="time"] { width: calc(100% - 16px); /* 100% menos el padding */ padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; /* Incluye padding y borde en el ancho */ } input[type="submit"], button { width: 100%; margin-top: 25px;background-color: #0077cc; color: white; padding: 12px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; transition: background-color 0.3s ease; } button:hover { background-color: #005f99; } .success { color: green;background-color: #e6ffe6; border: 1px solid green; padding: 10px; border-radius: 5px; margin-top: 15px; text-align: center; } .error { color: red; background-color: #ffe6e6; border: 1px solid red; padding: 10px; border-radius: 5px; margin-top: 15px; text-align: center; } </style> </head> <body> <h2>Reservar Sala White</h2> <form id="reservaForm"><label for="name">Nombre / Name:</label> <input type="text" id="name" name="name" required> <labelfor="email">Email:</label> <input type="email" id="email" name="email" required> <label for="date">Fecha / Date:</label> <input type="date" id="date" name="date" required> <label for="startTime">Hora de inicio / Start Time:</label> <input type="time" id="startTime" name="startTime" min="08:00" max="20:00" required> <labelfor="endTime">Hora de fin / End Time:</label> <input type="time" id="endTime" name="endTime" min="08:00"max="20:00" required> <input type="hidden" name="sala" value="Sala White"> <button type="submit">Reservar / Book</button> <p class="success" id="mensaje"></p> <p class="error" id="error"></p> </form> <script> // ESTA URL SE LLENARÁ MÁS TARDE, CUANDO HAYAMOS DESPLEGADO EL APPS SCRIPT const scriptURL = ""; // ¡IMPORTANTE! Dejar vacío por ahora, lo copiaremos después.document.getElementById("reservaForm").addEventListener("submit", async function(e) { console.log("¡Formulario enviado!"); e.preventDefault(); // Previene el envío del formulario tradicional const form = this; const start = form.startTime.value; const end = form.endTime.value; const mensaje = document.getElementById("mensaje"); const error = document.getElementById("error"); mensaje.textContent = ""; // Limpia mensajes anteriores error.textContent = "";  // Limpia errores anteriores if (!scriptURL) { error.textContent = "❌ Error de configuración: La URL del Apps Script no está definida. Por favor, contacta al administrador."; console.error("scriptURL is not defined. Please set it after deploying Apps Script."); return; } // Validación de duración máxima de 2 horas // Creamos fechas ficticias para poder comparar las horas. const startDate = new Date("1970-01-01T" + start + ":00"); const endDate = new Date("1970-01-01T" + end + ":00"); const diff = (endDate - startDate) / (1000 * 60); // diferencia en minutos if (diff <= 0 || diff > 120) { error.textContent = "❌ La duración debe ser de máximo 2 horas y la hora de fin debe ser posterior a la de inicio."; return; // Detiene la ejecución si la validación falla } // Deshabilitar botón y mostrar mensaje de carga const submitButton = form.querySelector('button[type="submit"]'); submitButton.disabled = true; submitButton.textContent = "Reservando...";// Recopilar los datos del formulario const formData = new FormData(form); const data = {}; for (let [key, value] offormData.entries()) { data[key] = value; } try { const response = await fetch(scriptURL, { method: 'POST', body: JSON.stringify(data), // Envía los datos como JSON headers: { 'Content-Type': 'application/json' // Indica que el cuerpo es JSON } }); const result = await response.json(); // Espera una respuesta JSON de tu Apps Script if (result.result === "success") { mensaje.textContent = "✅ Reserva realizada con éxito!"; form.reset(); // Opcional: Limpia el formulario después del éxito } else { error.textContent = "❌ Error al realizar la reserva: " + (result.message || "Error desconocido.");console.error("Error en Apps Script:", result.message); // Muestra el error en la consola } } catch (fetchError) { error.textContent = "❌ Error de conexión. Por favor, inténtalo de nuevo más tarde o contacta al soporte.";console.error("Error de fetch:", fetchError); // Muestra el error de red en la consola } finally { submitButton.disabled = false; submitButton.textContent = "Reservar / Book"; } }); </script> </body> </html>